"use strict";(self.webpackChunkhydra_head_protocol_docs=self.webpackChunkhydra_head_protocol_docs||[]).push([[3356],{89720:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>m,frontMatter:()=>c,metadata:()=>d,toc:()=>s});const d=JSON.parse('{"id":"dev/protocol","title":"Protocol","description":"Additional implementation-specific documentation for the Hydra Head protocol and extensions like incremental decommits.","source":"@site/docs/dev/protocol.md","sourceDirName":"dev","slug":"/dev/protocol","permalink":"/head-protocol/unstable/docs/dev/protocol","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-scaling/hydra/tree/master/docs/docs/dev/protocol.md","tags":[],"version":"current","frontMatter":{},"sidebar":"developerDocumentation","previous":{"title":"Specification","permalink":"/head-protocol/unstable/docs/dev/specification"},"next":{"title":"Incremental commits and decommits","permalink":"/head-protocol/unstable/docs/dev/incremental-commits-and-decommits"}}');var t=o(74848),i=o(28453);const c={},r="Protocol",a={},s=[{value:"Incremental Commits",id:"incremental-commits",level:3},{value:"Deposit flow",id:"deposit-flow",level:4},{value:"Recover flow",id:"recover-flow",level:4},{value:"Incremental Decommits",id:"incremental-decommits",level:3}];function l(e){const n={h1:"h1",h3:"h3",h4:"h4",header:"header",mermaid:"mermaid",p:"p",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"protocol",children:"Protocol"})}),"\n",(0,t.jsx)(n.p,{children:"Additional implementation-specific documentation for the Hydra Head protocol and extensions like incremental decommits."}),"\n",(0,t.jsx)(n.h3,{id:"incremental-commits",children:"Incremental Commits"}),"\n",(0,t.jsx)(n.h4,{id:"deposit-flow",children:"Deposit flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    Alice->>+Node A: POST /commit UTxO\n    Node A--\x3e>-Alice: depositTx\n\n    Alice ->> Alice: sign depositTx\n    Alice ->> Chain: submit depositTx\n\n    Chain ->>+ Node A: OnDepositTx utxo\n    Chain ->>+ Node B: OnDepositTx utxo\n\n    Node A --\x3e> Alice: CommitRecorded\n\n    par Alice isLeader\n        Node A->>Node A: ReqSn utxoToCommit\n    and\n        Node A->>Node B: ReqSn utxoToCommit\n    end\n\n    Node A->>Node A: sig = sign snapshot incl. utxoToCommit\n\n    par broadcast\n        Node A->>Node A: AckSn sig\n    and\n        Node A->>Node B: AckSn sig\n    end\n    Node B->>Node A: AckSn sig\n    Node A --\x3e> Alice: SnapshotConfirmed\n\n    Node A --\x3e> Alice: CommitApproved\n\n    Node A ->> Chain: IncrementTx snapshot sig\n    Chain ->> Node A: OnIncrementTx\n    Node A --\x3e> Alice: CommitFinalized"}),"\n",(0,t.jsx)(n.h4,{id:"recover-flow",children:"Recover flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    Alice->>+Node A: DELETE /commits/<tx-id>\n    Node A->>Chain: recoverTx\n    Chain ->>+ Node A: OnRecoverTx utxo\n    Chain ->>+ Node B: OnRecoverTx utxo\n    Node A --\x3e>- Alice: CommitRecovered\n    Node B --\x3e>- Bob: CommitRecovered\n    Node A--\x3e>-Alice: OK\n"}),"\n",(0,t.jsx)(n.h3,{id:"incremental-decommits",children:"Incremental Decommits"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    Alice->>+Node A: POST /decommit (decTx)\n    Node A--\x3e>-Alice: OK\n\n    Node A->>Node A: canApply decTx\n\n    par broadcast\n        Node A->>Node A: ReqDec decTx\n    and\n        Node A->>Node B: ReqDec decTx\n    end\n\n    Node A --\x3e> Alice: DecommitRequested\n\n    par Alice isLeader\n        Node A->>Node A: ReqSn decTx\n    and\n        Node A->>Node B: ReqSn decTx\n    end\n\n    Node A->>Node A: canApply decTx, decUTxO =  outputs(decTx)\n    Node A->>Node A: sig = sign snapshot incl. decUTxO\n\n    par broadcast\n        Node A->>Node A: AckSn sig\n    and\n        Node A->>Node B: AckSn sig\n    end\n\n    Node B->>Node A: AckSn sig\n\n    Node A --\x3e> Alice: SnapshotConfirmed\n    Node A --\x3e> Alice: DecommitApproved\n\n    Node A ->> Chain: DecrementTx snapshot sig\n    Chain ->> Node A: OnDecrementTx\n    Node A --\x3e> Alice: DecommitFinalized"})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>r});var d=o(96540);const t={},i=d.createContext(t);function c(e){const n=d.useContext(i);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),d.createElement(i.Provider,{value:n},e.children)}}}]);