"use strict";(self.webpackChunkhydra_head_protocol_docs=self.webpackChunkhydra_head_protocol_docs||[]).push([[1823],{43245:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"dev/commit_to_a_Head","title":"Commit funds to a Head","description":"In order to transact inside of a Head on L2 users need to have some funds","source":"@site/docs/dev/commit_to_a_Head.md","sourceDirName":"dev","slug":"/dev/commit_to_a_Head","permalink":"/head-protocol/unstable/docs/dev/commit_to_a_Head","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-scaling/hydra/tree/master/docs/docs/dev/commit_to_a_Head.md","tags":[],"version":"current","frontMatter":{},"sidebar":"developerDocumentation","previous":{"title":"Incremental commits and decommits","permalink":"/head-protocol/unstable/docs/dev/incremental-commits-and-decommits"},"next":{"title":"Architecture","permalink":"/head-protocol/unstable/docs/dev/architecture/"}}');var s=t(74848),i=t(28453);const r={},d="Commit funds to a Head",a={},c=[{value:"Commit process",id:"commit-process",level:3},{value:"Recovering the deposited funds",id:"recovering-the-deposited-funds",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"commit-funds-to-a-head",children:"Commit funds to a Head"})}),"\n",(0,s.jsx)(n.p,{children:"In order to transact inside of a Head on L2 users need to have some funds\navailable before staring the Head protocol."}),"\n",(0,s.jsx)(n.p,{children:"In addition to public key outputs users can also commit script outputs to a\nHead in order to accomodate different usecases for dApps and add custom validator logic."}),"\n",(0,s.jsx)(n.p,{children:"We can distinguish two types of commits:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Commit before the Head is open"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Commit when the Head is already opened (incremental commits)"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Both types of commits are pretty similar from the user perspective but the latter one\nis more useful since it depreciates the old behavior where the users needed to\nhave available funds before the Head protocol can actually be started."}),"\n",(0,s.jsxs)(n.p,{children:["In order to commit a ",(0,s.jsx)(n.code,{children:"UTxO"})," user owns on L1 they can choose to do what we call\na ",(0,s.jsx)(n.em,{children:"simple"})," or a ",(0,s.jsx)(n.em,{children:"blueprint"})," commit."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"Simple"})})," here means the user wants to commit a public key output to a Head in\nwhich case they only need to show the JSON representation of the ",(0,s.jsx)(n.code,{children:"UTxO"})," they\nown."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"blueprint"})})," option requires providing the ",(0,s.jsx)(n.em,{children:"blueprint"})," transaction\ntogether with the ",(0,s.jsx)(n.code,{children:"UTxO"})," it spends to be able to have more fine grained control\nover the commit process. Note that in this case ",(0,s.jsx)(n.code,{children:"hydra-node"})," ignores any\noutputs of a user transaction and is only concerned with the ",(0,s.jsx)(n.strong,{children:"inputs"})," it spends."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["For example when committing a script ",(0,s.jsx)(n.code,{children:"UTxO"})," and when more control of some of\nthe transaction attributes is needed (lower/upper validity bounds, custom\nredeemers, reference inputs etc.)"]})}),"\n",(0,s.jsx)(n.h3,{id:"commit-process",children:"Commit process"}),"\n",(0,s.jsxs)(n.p,{children:["Both commit options mentioned should not be different from the users\nperspective and the only difference is ",(0,s.jsx)(n.em,{children:"when"})," commit is made in the Head\n",(0,s.jsx)(n.a,{href:"./../protocol-overview#hydra-head-lifecycle",children:"lifecycle"})," - before or after the Head is opened."]}),"\n",(0,s.jsxs)(n.p,{children:["In any case user needs to have the ",(0,s.jsx)(n.code,{children:"hydra-node"})," running and be able to issue a\nrequest which is already described in more detailed\n",(0,s.jsx)(n.a,{href:"./../how-to/incremental-commit",children:"simple"})," and\n",(0,s.jsx)(n.a,{href:"./../how-to/commit-blueprint",children:"blueprint"})," tutorials."]}),"\n",(0,s.jsxs)(n.p,{children:["Upon succesfull request ",(0,s.jsx)(n.code,{children:"hydra-node"})," returns a transaction to the user which\nthen they need to sign and submit to the L1 network."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"hydra-node"})," constantly observes interesting L1 transactions and in case the\nHead is not yet opened it would wait for all other Head participants to commit\nbefore the Head protocol starts."]}),"\n",(0,s.jsxs)(n.p,{children:["When the Head is already opened we are talking about ",(0,s.jsx)(n.em,{children:"incremental commit"})," and\nwhat happens ",(0,s.jsx)(n.em,{children:"under the hood"})," is a bit different."]}),"\n",(0,s.jsxs)(n.p,{children:["To be able to commit to a running Head ",(0,s.jsx)(n.code,{children:"hydra-node"})," would lock the provided\n",(0,s.jsx)(n.code,{children:"UTxO"})," in the ",(0,s.jsx)(n.strong,{children:"deposit"})," script output controlled by the ",(0,s.jsx)(n.code,{children:"hydra-node"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["It would also set the deadline by which this locked ",(0,s.jsx)(n.code,{children:"UTxO"})," needs to be picked\nup and made available inside of L2 by posting a ",(0,s.jsx)(n.strong,{children:"increment"})," transaction. This\nalso happens automatically but here we want to describe this process and bring\nit closer to Hydra users."]}),"\n",(0,s.jsxs)(n.p,{children:["It is worthwhile mentioning that deposit deadline is double the value used for\ncontestation period. This gives the users control by specifying the\ncontestation period it in the arguments to ",(0,s.jsx)(n.code,{children:"hydra-node"})," executable."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Deadline information is present in the ",(0,s.jsx)(n.code,{children:"CommitRecorded"})," API server output."]})}),"\n",(0,s.jsx)(n.h3,{id:"recovering-the-deposited-funds",children:"Recovering the deposited funds"}),"\n",(0,s.jsxs)(n.p,{children:["If for some reason ",(0,s.jsx)(n.code,{children:"hydra-node"})," failed to observe the deposit there is a\n",(0,s.jsx)(n.strong,{children:"recover"})," process in place so that users can always have a way to unlock\ntheir funds."]}),"\n",(0,s.jsxs)(n.p,{children:["If the deadline is reached and the requested commit didn't show up on L2\nusers can request a recover by providing a ",(0,s.jsx)(n.code,{children:"TxId"})," of the deposit transaction\nwhich initially locked the funds."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Users can also request to see pending deposits. See our api ",(0,s.jsx)(n.a,{href:"/api-reference",children:"documentation"}),"."]})}),"\n",(0,s.jsx)(n.p,{children:"Any Head participant can request to recover the deposit not only the one which initially deposited the funds."})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var o=t(96540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);