<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-dev/architecture/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Architecture | Hydra Head protocol documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hydra.family/head-protocol/docs/dev/architecture/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture | Hydra Head protocol documentation"><meta data-rh="true" name="description" content="This document describes the architecture of the current implementation"><meta data-rh="true" property="og:description" content="This document describes the architecture of the current implementation"><link data-rh="true" rel="icon" href="/head-protocol/img/hydra.png"><link data-rh="true" rel="canonical" href="https://hydra.family/head-protocol/docs/dev/architecture/"><link data-rh="true" rel="alternate" href="https://hydra.family/head-protocol/docs/dev/architecture/" hreflang="en"><link data-rh="true" rel="alternate" href="https://hydra.family/head-protocol/docs/dev/architecture/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OF3CR7K89X-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/head-protocol/adr/rss.xml" title="Hydra Head protocol documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/head-protocol/adr/atom.xml" title="Hydra Head protocol documentation Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Hydra Head protocol documentation" href="/head-protocol/opensearch.xml">







<script src="https://plausible.io/js/script.js" defer="defer" data-domain="hydra.family"></script><link rel="stylesheet" href="/head-protocol/assets/css/styles.be8f7726.css">
<link rel="preload" href="/head-protocol/assets/js/runtime~main.0c27f7af.js" as="script">
<link rel="preload" href="/head-protocol/assets/js/main.908a8c3e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header aria-label="Main" class="flex navbar tablet:py-[30px] !px-0 shadow-none z-50 border-b border-[#EAEAEB] pt-3 pb-4 tablet:px-2 navbar--fixed-top"><div class="w-full px-6"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/head-protocol/"><div class="navbar__logo"><img src="/head-protocol/img/hydra.png" alt="Hydra Head protocol" class="themedImage_ToTc themedImage--light_HNdA" style="height:27px;margin-top:2.5px"><img src="/head-protocol/img/hydra-white.png" alt="Hydra Head protocol" class="themedImage_ToTc themedImage--dark_i4oU" style="height:27px;margin-top:2.5px"></div></a><a aria-current="page" class="hover:text-primary-light navbar__item navbar__link navbar__link--active" href="/head-protocol/docs">User manual</a><a aria-current="page" class="hover:text-primary-light navbar__item navbar__link navbar__link--active" href="/head-protocol/docs/dev">Developer documentation</a></div><div class="navbar__items navbar__items--right"><a class="hover:text-primary-light navbar__item navbar__link" href="/head-protocol/topologies">Topologies</a><a class="hover:text-primary-light navbar__item navbar__link" href="/head-protocol/use-cases">Use cases</a><a class="hover:text-primary-light navbar__item navbar__link" href="/head-protocol/docs/faqs">FAQs</a><div class="py-1 mx-3"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://github.com/cardano-scaling/hydra" target="_blank" rel="noopener noreferrer" class="hover:text-primary-light mx-3 py-1"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="24" viewBox="0 0 25 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.279 0C5.48905 0 0 5.49998 0 12.3042C0 17.7432 3.51702 22.3472 8.39607 23.9767C9.00607 24.0991 9.22952 23.7119 9.22952 23.3862C9.22952 23.1009 9.20941 22.1232 9.20941 21.1044C5.79368 21.8379 5.08238 19.6377 5.08238 19.6377C4.53345 18.2117 3.72011 17.8452 3.72011 17.8452C2.60214 17.0914 3.80154 17.0914 3.80154 17.0914C5.04166 17.1729 5.69239 18.3544 5.69239 18.3544C6.78999 20.2284 8.55869 19.6989 9.27023 19.3729C9.37178 18.5784 9.69726 18.0284 10.0429 17.7229C7.31857 17.4377 4.45227 16.3784 4.45227 11.6522C4.45227 10.3077 4.93987 9.20771 5.71249 8.35222C5.59059 8.04672 5.16356 6.78347 5.83464 5.09273C5.83464 5.09273 6.87143 4.76673 9.20916 6.35572C10.21 6.08639 11.2422 5.94938 12.279 5.94823C13.3158 5.94823 14.3727 6.09097 15.3487 6.35572C17.6867 4.76673 18.7234 5.09273 18.7234 5.09273C19.3945 6.78347 18.9672 8.04672 18.8453 8.35222C19.6383 9.20771 20.1058 10.3077 20.1058 11.6522C20.1058 16.3784 17.2395 17.4172 14.4949 17.7229C14.9423 18.1099 15.3283 18.8432 15.3283 20.0044C15.3283 21.6544 15.3082 22.9787 15.3082 23.3859C15.3082 23.7119 15.5319 24.0991 16.1417 23.9769C21.0207 22.3469 24.5377 17.7432 24.5377 12.3042C24.5578 5.49998 19.0487 0 12.279 0Z" fill="currentColor"></path></svg></a><a href="https://discord.com/invite/Qq5vNTg9PT" target="_blank" rel="noopener noreferrer" class="hover:text-primary-light mx-3 py-1"><svg xmlns="http://www.w3.org/2000/svg" width="23" height="18" viewBox="0 0 23 18"><path d="M19.4778 1.49632C18.0074 0.806713 16.4357 0.286253 14.7879 0C14.7626 0 14.7246 0 14.7119 0.0390345C14.5091 0.403356 14.2809 0.884782 14.1288 1.27513C12.3543 1.00189 10.6051 1.00189 8.8686 1.27513C8.71649 0.884782 8.47566 0.416368 8.27286 0.0390345C8.26019 0.0130115 8.22216 0 8.19681 0C6.54903 0.286253 4.9773 0.793701 3.51965 1.49632C3.50697 1.49632 3.4943 1.50933 3.4943 1.52234C0.50294 6.08938 -0.308275 10.5523 0.0973328 14.9632C0.0973328 14.9892 0.110008 15.0023 0.122683 15.0153C2.08734 16.4986 4.00131 17.3964 5.86457 17.9949C5.88992 17.9949 5.92794 17.9949 5.94062 17.9689C6.38425 17.3443 6.77718 16.6937 7.11941 16.0041C7.14476 15.9651 7.11941 15.9131 7.08139 15.9C6.4603 15.6528 5.86457 15.3536 5.2815 15.0283C5.2308 15.0023 5.2308 14.9372 5.2815 14.8982C5.40826 14.8071 5.52233 14.703 5.63641 14.6119C5.66176 14.5989 5.68711 14.5859 5.71246 14.6119C9.47701 16.3815 13.5584 16.3815 17.2723 14.6119C17.2976 14.6119 17.323 14.6119 17.3483 14.6119C17.4624 14.703 17.5892 14.8071 17.7032 14.8982C17.7413 14.9242 17.7413 15.0023 17.7032 15.0283C17.1328 15.3666 16.5371 15.6658 15.9034 15.9C15.8653 15.9131 15.84 15.9651 15.8653 16.0041C16.2076 16.6937 16.6005 17.3443 17.0441 17.9689C17.0568 17.9949 17.0948 18.0079 17.1202 17.9949C18.9961 17.3964 20.9101 16.4986 22.8747 15.0153C22.8874 15.0023 22.9001 14.9762 22.9001 14.9632C23.3817 9.86271 22.1015 5.4388 19.5031 1.52234C19.5031 1.50933 19.4904 1.49632 19.4778 1.49632ZM7.6898 12.2828C6.5617 12.2828 5.62374 11.2159 5.62374 9.90175C5.62374 8.58759 6.53635 7.52064 7.6898 7.52064C8.84325 7.52064 9.78121 8.6006 9.75586 9.90175C9.75586 11.2159 8.84325 12.2828 7.6898 12.2828ZM15.333 12.2828C14.2049 12.2828 13.2669 11.2159 13.2669 9.90175C13.2669 8.58759 14.1795 7.52064 15.333 7.52064C16.4864 7.52064 17.4244 8.6006 17.399 9.90175C17.399 11.2159 16.4864 12.2828 15.333 12.2828Z" fill="currentColor"></path></svg></a><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></header><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/">About Hydra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/specification">Specification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/protocol">Protocol</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--active" aria-current="page" href="/head-protocol/docs/dev/architecture/">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/head-protocol/docs/dev/architecture/networking">Networking</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/rollbacks/">Handling rollbacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item sidebar-header"><small><b>Background</b></small></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/scalability">Scalability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/layer-two">Layer 2 solutions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item sidebar-header"><small><b>Reference</b></small></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/docs/dev/haskell-packages">Haskell packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/adr">Architecture Decision Records</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="inline-flex p-4 mx-6 justify-between">Collapse side panel <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.3258 14.9258V9.07578L12.3758 12.0008L15.3258 14.9258ZM5.80078 19.7008C5.38411 19.7008 5.02995 19.5549 4.73828 19.2633C4.44661 18.9716 4.30078 18.6174 4.30078 18.2008V5.80078C4.30078 5.38411 4.44661 5.02995 4.73828 4.73828C5.02995 4.44661 5.38411 4.30078 5.80078 4.30078H18.2008C18.6174 4.30078 18.9716 4.44661 19.2633 4.73828C19.5549 5.02995 19.7008 5.38411 19.7008 5.80078V18.2008C19.7008 18.6174 19.5549 18.9716 19.2633 19.2633C18.9716 19.5549 18.6174 19.7008 18.2008 19.7008H5.80078ZM8.00078 19.0008V5.00078H5.80078C5.60078 5.00078 5.41745 5.08411 5.25078 5.25078C5.08411 5.41745 5.00078 5.60078 5.00078 5.80078V18.2008C5.00078 18.4008 5.08411 18.5841 5.25078 18.7508C5.41745 18.9174 5.60078 19.0008 5.80078 19.0008H8.00078ZM8.70078 19.0008H18.2008C18.4008 19.0008 18.5841 18.9174 18.7508 18.7508C18.9174 18.5841 19.0008 18.4008 19.0008 18.2008V5.80078C19.0008 5.60078 18.9174 5.41745 18.7508 5.25078C18.5841 5.08411 18.4008 5.00078 18.2008 5.00078H8.70078V19.0008Z" fill="black"></path></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/head-protocol/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Architecture</h1><p>This document describes the architecture of the current implementation
of a <code>hydra-node</code>. The following diagram represents the main
components of a Hydra node using the <a href="https://c4model.com/#ComponentDiagram" target="_blank" rel="noopener noreferrer">C4 Component
Diagram</a> notation.</p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="843" preserveAspectRatio="none" style="width:1501px;height:843px;background:#fff" viewBox="0 0 1501 843" width="1501" class="architecture"><text font-family="sans-serif" font-size="14" font-weight="bold" textLength="151" x="668.25" y="22.995">Hydra Components</text><rect fill="none" height="571.71" rx="2.5" ry="2.5" style="stroke:#444;stroke-width:1;stroke-dasharray:7,7" width="927" x="309" y="44.297"></rect><text fill="#444" font-family="sans-serif" font-size="16" font-weight="bold" textLength="103" x="721" y="81.148">Hydra Node</text><text fill="#444" font-family="sans-serif" font-size="12" font-weight="bold" textLength="78" x="733.5" y="96.061">[container]</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Persistence.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Persistence.hs" xlink:type="simple"><rect fill="#85BBF0" height="115.453" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="219" x="430.5" y="115.297"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="497.5" y="136.435">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="106" x="487" y="154.117">Persistence</text><text font-family="sans-serif" font-size="12" font-style="italic" textLength="58" x="511" y="169.029">[JSON/FS]</text><text font-family="sans-serif" font-size="14" textLength="4" x="538" y="184.855"></text><text font-family="sans-serif" font-size="14" textLength="55" x="440.5" y="201.151">Persists</text><text font-family="sans-serif" font-size="14" textLength="4" x="495.5" y="201.151"></text><text font-family="sans-serif" font-size="14" textLength="35" x="499.5" y="201.151">state</text><text font-family="sans-serif" font-size="14" textLength="4" x="534.5" y="201.151"></text><text font-family="sans-serif" font-size="14" textLength="13" x="538.5" y="201.151">of</text><text font-family="sans-serif" font-size="14" textLength="4" x="551.5" y="201.151"></text><text font-family="sans-serif" font-size="14" textLength="23" x="555.5" y="201.151">the</text><text font-family="sans-serif" font-size="14" textLength="4" x="578.5" y="201.151"></text><text font-family="sans-serif" font-size="14" textLength="35" x="582.5" y="201.151">head</text><text font-family="sans-serif" font-size="14" textLength="4" x="617.5" y="201.151"></text><text font-family="sans-serif" font-size="14" textLength="18" x="621.5" y="201.151">on</text><text font-family="sans-serif" font-size="14" textLength="28" x="526" y="217.448">disk</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/HeadLogic.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/HeadLogic.hs" xlink:type="simple"><rect fill="#85BBF0" height="101.484" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="219" x="658.5" y="291.747"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="725.5" y="312.885">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="44" x="720" y="330.567">Head</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="764" y="330.567"></text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="46" x="770" y="330.567">Logic</text><text font-family="sans-serif" font-size="14" textLength="4" x="766" y="347.336"></text><text font-family="sans-serif" font-size="14" textLength="65" x="668.5" y="363.633">Maintains</text><text font-family="sans-serif" font-size="14" textLength="4" x="733.5" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="51" x="737.5" y="363.633">internal</text><text font-family="sans-serif" font-size="14" textLength="4" x="788.5" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="36" x="792.5" y="363.633">Head</text><text font-family="sans-serif" font-size="14" textLength="4" x="828.5" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="35" x="832.5" y="363.633">state</text><text font-family="sans-serif" font-size="14" textLength="26" x="691" y="379.93">and</text><text font-family="sans-serif" font-size="14" textLength="4" x="717" y="379.93"></text><text font-family="sans-serif" font-size="14" textLength="73" x="721" y="379.93">processes</text><text font-family="sans-serif" font-size="14" textLength="4" x="794" y="379.93"></text><text font-family="sans-serif" font-size="14" textLength="47" x="798" y="379.93">events</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/API/Server.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/API/Server.hs" xlink:type="simple"><rect fill="#85BBF0" height="101.484" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="210" x="1010" y="291.747"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="1072.5" y="312.885">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="30" x="1067.5" y="330.567">API</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="1097.5" y="330.567"></text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="59" x="1103.5" y="330.567">Server</text><text font-family="sans-serif" font-size="14" textLength="4" x="1113" y="347.336"></text><text font-family="sans-serif" font-size="14" textLength="48" x="1022" y="363.633">Handle</text><text font-family="sans-serif" font-size="14" textLength="4" x="1070" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="37" x="1074" y="363.633">client</text><text font-family="sans-serif" font-size="14" textLength="4" x="1111" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="77" x="1115" y="363.633">commands</text><text font-family="sans-serif" font-size="14" textLength="4" x="1192" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="12" x="1196" y="363.633">&amp;</text><text font-family="sans-serif" font-size="14" textLength="52" x="1020" y="379.93">queries</text><text font-family="sans-serif" font-size="14" textLength="4" x="1072" y="379.93"></text><text font-family="sans-serif" font-size="14" textLength="26" x="1076" y="379.93">and</text><text font-family="sans-serif" font-size="14" textLength="4" x="1102" y="379.93"></text><text font-family="sans-serif" font-size="14" textLength="46" x="1106" y="379.93">serves</text><text font-family="sans-serif" font-size="14" textLength="4" x="1152" y="379.93"></text><text font-family="sans-serif" font-size="14" textLength="54" x="1156" y="379.93">outputs</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Chain.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Chain.hs" xlink:type="simple"><rect fill="#85BBF0" height="117.781" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="196" x="683" y="482.227"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="738.5" y="503.365">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="48" x="757" y="521.047">Chain</text><text font-family="sans-serif" font-size="14" textLength="4" x="779" y="537.816"></text><text font-family="sans-serif" font-size="14" textLength="80" x="701" y="554.113">Connection</text><text font-family="sans-serif" font-size="14" textLength="4" x="781" y="554.113"></text><text font-family="sans-serif" font-size="14" textLength="14" x="785" y="554.113">to</text><text font-family="sans-serif" font-size="14" textLength="4" x="799" y="554.113"></text><text font-family="sans-serif" font-size="14" textLength="58" x="803" y="554.113">Cardano</text><text font-family="sans-serif" font-size="14" textLength="58" x="693" y="570.409">Observe</text><text font-family="sans-serif" font-size="14" textLength="4" x="751" y="570.409"></text><text font-family="sans-serif" font-size="14" textLength="20" x="755" y="570.409">txs</text><text font-family="sans-serif" font-size="14" textLength="4" x="775" y="570.409"></text><text font-family="sans-serif" font-size="14" textLength="60" x="779" y="570.409">on-chain</text><text font-family="sans-serif" font-size="14" textLength="4" x="839" y="570.409"></text><text font-family="sans-serif" font-size="14" textLength="26" x="843" y="570.409">and</text><text font-family="sans-serif" font-size="14" textLength="31" x="728" y="586.706">post</text><text font-family="sans-serif" font-size="14" textLength="4" x="759" y="586.706"></text><text font-family="sans-serif" font-size="14" textLength="12" x="763" y="586.706">tx</text><text font-family="sans-serif" font-size="14" textLength="4" x="775" y="586.706"></text><text font-family="sans-serif" font-size="14" textLength="14" x="779" y="586.706">to</text><text font-family="sans-serif" font-size="14" textLength="4" x="793" y="586.706"></text><text font-family="sans-serif" font-size="14" textLength="37" x="797" y="586.706">chain</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Chain/Direct/Wallet.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Chain/Direct/Wallet.hs" xlink:type="simple"><rect fill="#85BBF0" height="101.484" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="197" x="324.5" y="490.377"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="380.5" y="511.515">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="55" x="395.5" y="529.197">Wallet</text><text font-family="sans-serif" font-size="14" textLength="4" x="421" y="545.966"></text><text font-family="sans-serif" font-size="14" textLength="76" x="337" y="562.263">Embedded</text><text font-family="sans-serif" font-size="14" textLength="4" x="413" y="562.263"></text><text font-family="sans-serif" font-size="14" textLength="41" x="417" y="562.263">Wallet</text><text font-family="sans-serif" font-size="14" textLength="4" x="458" y="562.263"></text><text font-family="sans-serif" font-size="14" textLength="14" x="462" y="562.263">to</text><text font-family="sans-serif" font-size="14" textLength="4" x="476" y="562.263"></text><text font-family="sans-serif" font-size="14" textLength="29" x="480" y="562.263">sign</text><text font-family="sans-serif" font-size="14" textLength="85" x="334.5" y="578.559">transactions</text><text font-family="sans-serif" font-size="14" textLength="4" x="419.5" y="578.559"></text><text font-family="sans-serif" font-size="14" textLength="26" x="423.5" y="578.559">and</text><text font-family="sans-serif" font-size="14" textLength="4" x="449.5" y="578.559"></text><text font-family="sans-serif" font-size="14" textLength="24" x="453.5" y="578.559">pay</text><text font-family="sans-serif" font-size="14" textLength="4" x="477.5" y="578.559"></text><text font-family="sans-serif" font-size="14" textLength="30" x="481.5" y="578.559">fees</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Network.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Network.hs" xlink:type="simple"><rect fill="#85BBF0" height="101.484" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="191" x="325.5" y="291.747"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="378.5" y="312.885">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="77" x="382.5" y="330.567">Network</text><text font-family="sans-serif" font-size="14" textLength="4" x="419" y="347.336"></text><text font-family="sans-serif" font-size="14" textLength="63" x="335.5" y="363.633">Manages</text><text font-family="sans-serif" font-size="14" textLength="4" x="398.5" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="86" x="402.5" y="363.633">connections</text><text font-family="sans-serif" font-size="14" textLength="4" x="488.5" y="363.633"></text><text font-family="sans-serif" font-size="14" textLength="14" x="492.5" y="363.633">to</text><text font-family="sans-serif" font-size="14" textLength="40" x="401" y="379.93">peers</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Logging.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Logging.hs" xlink:type="simple"><rect fill="#85BBF0" height="85.188" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="166" x="685" y="130.427"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="725.5" y="151.565">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="69" x="733.5" y="169.247">Logging</text><text font-family="sans-serif" font-size="14" textLength="4" x="766" y="186.016"></text><text font-family="sans-serif" font-size="14" textLength="42" x="695" y="202.313">Dump</text><text font-family="sans-serif" font-size="14" textLength="4" x="737" y="202.313"></text><text font-family="sans-serif" font-size="14" textLength="33" x="741" y="202.313">JSON</text><text font-family="sans-serif" font-size="14" textLength="4" x="774" y="202.313"></text><text font-family="sans-serif" font-size="14" textLength="14" x="778" y="202.313">to</text><text font-family="sans-serif" font-size="14" textLength="4" x="792" y="202.313"></text><text font-family="sans-serif" font-size="14" textLength="45" x="796" y="202.313">stdout</text></a><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Logging/Monitoring.hs" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/blob/master/hydra-node/src/Hydra/Logging/Monitoring.hs" xlink:type="simple"><rect fill="#85BBF0" height="101.484" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="168" x="886" y="122.277"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="927.5" y="143.416">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="95" x="922.5" y="161.097">Monitoring</text><text font-family="sans-serif" font-size="14" textLength="4" x="968" y="177.866"></text><text font-family="sans-serif" font-size="14" textLength="59" x="896" y="194.163">Exposes</text><text font-family="sans-serif" font-size="14" textLength="4" x="955" y="194.163"></text><text font-family="sans-serif" font-size="14" textLength="85" x="959" y="194.163">Prometheus</text><text font-family="sans-serif" font-size="14" textLength="51" x="944.5" y="210.459">metrics</text></a><rect fill="#23AA12" height="85.188" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="178" x="914" y="498.527"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="151" x="927.5" y="519.665">«external»«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="73" x="932.5" y="537.347">Cardano</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="1005.5" y="537.347"></text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="62" x="1011.5" y="537.347">Ledger</text><text font-family="sans-serif" font-size="14" textLength="4" x="1001" y="554.116"></text><text font-family="sans-serif" font-size="14" textLength="65" x="924" y="570.413">Maintains</text><text font-family="sans-serif" font-size="14" textLength="4" x="989" y="570.413"></text><text font-family="sans-serif" font-size="14" textLength="36" x="993" y="570.413">Layer</text><text font-family="sans-serif" font-size="14" textLength="4" x="1029" y="570.413"></text><text font-family="sans-serif" font-size="14" textLength="9" x="1033" y="570.413">2</text><text font-family="sans-serif" font-size="14" textLength="4" x="1042" y="570.413"></text><text font-family="sans-serif" font-size="14" textLength="36" x="1046" y="570.413">State</text><rect fill="#438DD5" height="66.563" rx="2.5" ry="2.5" style="stroke:#3c7fc0;stroke-width:0.5" width="184" x="7" y="309.207"></rect><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="74" x="62" y="330.346">«container»</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="51" x="17" y="348.027">Hydra</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="68" y="348.027"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="46" x="74" y="348.027">Node</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="120" y="348.027"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="55" x="126" y="348.027">(peer)</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="38" x="31.5" y="362.939">[Local</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="69.5" y="362.939"></text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="93" x="73.5" y="362.939">cardano-node]</text><rect fill="#438DD5" height="66.563" rx="2.5" ry="2.5" style="stroke:#3c7fc0;stroke-width:0.5" width="150" x="466" y="728.917"></rect><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="74" x="504" y="750.056">«container»</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="73" x="478.5" y="767.737">Cardano</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="551.5" y="767.737"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="46" x="557.5" y="767.737">Node</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="38" x="476" y="782.649">[Local</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="514" y="782.649"></text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="88" x="518" y="782.649">cadano-node]</text><rect fill="#438DD5" height="66.563" rx="2.5" ry="2.5" style="stroke:#3c7fc0;stroke-width:0.5" width="206" x="62" y="507.837"></rect><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="74" x="128" y="528.976">«container»</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="73" x="72" y="546.657">Cardano</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="145" y="546.657"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="46" x="151" y="546.657">Node</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="197" y="546.657"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="55" x="203" y="546.657">(peer)</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="38" x="97.5" y="561.569">[Local</text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="135.5" y="561.569"></text><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="93" x="139.5" y="561.569">cardano-node]</text><rect fill="#438DD5" height="52.594" rx="2.5" ry="2.5" style="stroke:#3c7fc0;stroke-width:0.5" width="127" x="1368.5" y="316.187"></rect><text fill="#FFF" font-family="sans-serif" font-size="12" font-style="italic" textLength="74" x="1395" y="337.325">«container»</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="51" x="1378.5" y="355.007">Hydra</text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="1429.5" y="355.007"></text><text fill="#FFF" font-family="sans-serif" font-size="16" font-weight="bold" textLength="50" x="1435.5" y="355.007">Client</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/cardano-scaling/hydra/tree/master/hydra-plutus" xlink:show="new" xlink:title="https://github.com/cardano-scaling/hydra/tree/master/hydra-plutus" xlink:type="simple"><rect fill="#85BBF0" height="150.375" rx="2.5" ry="2.5" style="stroke:#78a8d8;stroke-width:0.5" width="208" x="677" y="687.007"></rect><text font-family="sans-serif" font-size="12" font-style="italic" textLength="85" x="738.5" y="708.145">«component»</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="51" x="726" y="725.827">Hydra</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="6" x="777" y="725.827"></text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="53" x="783" y="725.827">Smart</text><text font-family="sans-serif" font-size="16" font-weight="bold" textLength="88" x="737" y="744.452">Contracts</text><text font-family="sans-serif" font-size="12" font-style="italic" textLength="47" x="757.5" y="759.364">[Plutus]</text><text font-family="sans-serif" font-size="14" textLength="4" x="779" y="775.189"></text><text font-family="sans-serif" font-size="14" textLength="62" x="694" y="791.486">On-chain</text><text font-family="sans-serif" font-size="14" textLength="4" x="756" y="791.486"></text><text font-family="sans-serif" font-size="14" textLength="39" x="760" y="791.486">smart</text><text font-family="sans-serif" font-size="14" textLength="4" x="799" y="791.486"></text><text font-family="sans-serif" font-size="14" textLength="65" x="803" y="791.486">contracts</text><text font-family="sans-serif" font-size="14" textLength="72" x="687" y="807.783">controlling</text><text font-family="sans-serif" font-size="14" textLength="4" x="759" y="807.783"></text><text font-family="sans-serif" font-size="14" textLength="23" x="763" y="807.783">the</text><text font-family="sans-serif" font-size="14" textLength="4" x="786" y="807.783"></text><text font-family="sans-serif" font-size="14" textLength="68" x="790" y="807.783">behaviour</text><text font-family="sans-serif" font-size="14" textLength="4" x="858" y="807.783"></text><text font-family="sans-serif" font-size="14" textLength="13" x="862" y="807.783">of</text><text font-family="sans-serif" font-size="14" textLength="23" x="707" y="824.08">the</text><text font-family="sans-serif" font-size="14" textLength="4" x="730" y="824.08"></text><text font-family="sans-serif" font-size="14" textLength="57" x="734" y="824.08">protocol</text><text font-family="sans-serif" font-size="14" textLength="4" x="791" y="824.08"></text><text font-family="sans-serif" font-size="14" textLength="60" x="795" y="824.08">on-chain</text></a><path d="M525.58 342.487H649.4" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m517.74 342.487 8 3v-6l-8 3zM657.17 342.487l-8-3v6l8-3z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="42" x="535" y="322.625">Hydra</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="4" x="577" y="322.625"></text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="59" x="581" y="322.625">Protocol</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="72" x="551.5" y="336.594">Messages</text><path d="M886.78 342.487h114.26" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m878.79 342.487 8 3v-6l-8 3zM1008.77 342.487l-8-3v6l8-3z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="78" x="897.75" y="322.625">ClientInput</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="4" x="975.75" y="322.625"></text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="10" x="979.75" y="322.625">&amp;</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="96" x="895.75" y="336.594">ServerOutput</text><path d="M771.89 402.347c1.48 22.36 3.17 47.99 4.7 71.03" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m771.31 394.617-2.465 8.18 5.987-.396-3.522-7.784zM777.16 481.067l2.465-8.18-5.987.396 3.522 7.784z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="87" x="775" y="435.365">Observation</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="4" x="862" y="435.365"></text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="10" x="866" y="435.365">&amp;</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="75" x="788" y="449.334">OnChainTx</text><path d="M845.92 393.667c13.35 9.41 26.85 19.48 39.08 29.56 25.52 21.04 51.85 46.69 73.15 68.59" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m963.31 497.187-3.397-7.84-4.317 4.167 7.714 3.673z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="39" x="916" y="442.365">Apply</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="4" x="955" y="442.365"></text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="15" x="959" y="442.365">Tx</text><path d="M530.68 541.117h151.87" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m522.77 541.117 8 3v-6l-8 3z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="31" x="539.75" y="535.255">Sign</text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="4" x="570.75" y="535.255"></text><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="90" x="574.75" y="535.255">transactions</text><path d="M781 600.257v77.7" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m781 685.647 3-8h-6l3 8z"></path><text fill="#666" font-family="sans-serif" font-size="12" font-weight="bold" textLength="27" x="782" y="649.145">Use</text><path d="M708.45 606.347c-9.59 8.6-19.28 17.32-28.45 25.66-33.17 30.17-70.35 64.77-97.91 90.57" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m714.08 601.427-7.966 3.088 3.994 4.477 3.972-7.565zM576.65 727.607l7.89-3.279-4.101-4.38-3.789 7.659z"></path><text fill="#666" font-family="sans-serif" font-size="0" textLength="0" x="726.5" y="633.007">.</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="30" x="681" y="654.145">[N2C</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="711" y="654.145"></text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="57" x="715" y="654.145">protocol]</text><path d="M228.56 579.157c69.29 40.37 179.53 104.6 248.84 144.98" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m221.89 574.687 5.402 6.62 3.02-5.185-8.422-1.435zM483.81 728.457l-5.396-6.625-3.025 5.182 8.421 1.443z"></path><text fill="#666" font-family="sans-serif" font-size="0" textLength="0" x="400" y="633.007">.</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="31" x="354" y="654.145">[N2N</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="385" y="654.145"></text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="57" x="389" y="654.145">protocol]</text><path d="M112.74 384.417c11.31 33.72 27.28 81.28 38.58 114.94" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m109.9 376.957-.287 8.539 5.685-1.917-5.398-6.622zM154.09 506.607l.297-8.539-5.688 1.91 5.391 6.629z"></path><text fill="#666" font-family="sans-serif" font-size="0" textLength="0" x="180.5" y="426.227">.</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="30" x="135" y="447.365">[N2C</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="165" y="447.365"></text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="57" x="169" y="447.365">protocol]</text><path d="M200.22 342.487h115.99" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m192.27 342.487 8 3v-6l-8 3zM324.07 342.487l-8-3v6l8-3z"></path><text fill="#666" font-family="sans-serif" font-size="0" textLength="0" x="258.25" y="301.487">.</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="42" x="209.25" y="322.625">[Hydra</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="4" x="251.25" y="322.625"></text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="52" x="255.25" y="322.625">Network</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="57" x="229.75" y="336.594">protocol]</text><path d="M1229.1 342.487h130.6" fill="none" style="stroke:#666;stroke-width:1"></path><path fill="#666" style="stroke:#666;stroke-width:1" d="m1221.12 342.487 8 3v-6l-8 3zM1367.29 342.487l-8-3v6l8-3z"></path><text fill="#666" font-family="sans-serif" font-size="0" textLength="0" x="1294.25" y="315.487">.</text><text fill="#666" font-family="sans-serif" font-size="12" font-style="italic" textLength="112" x="1238.25" y="336.625">[JSON/Websocket]</text></svg><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>This diagram is manually produced using the <a href="https://plantuml.com" target="_blank" rel="noopener noreferrer">PlantUML</a> graphing tool with <a href="https://github.com/plantuml-stdlib/C4-PlantUML" target="_blank" rel="noopener noreferrer">C4 extensions</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ plantuml -Tsvg architecture-c4.puml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network">Network<a href="#network" class="hash-link" aria-label="Direct link to Network" title="Direct link to Network">​</a></h3><p>The <em>network</em> component is responsible for all communications between Hydra nodes related to the off-chain part of the Hydra protocol. The <a href="/head-protocol/docs/dev/architecture/networking">current implementation</a> is based on the <a href="https://github.com/input-output-hk/typed-protocols" target="_blank" rel="noopener noreferrer">typed protocols</a> library, which is also used by the Cardano networking. It is asynchronous by nature and uses a push-based protocol with a uniform <em>broadcast</em> abstraction.</p><p>Messages are exchanged between nodes during different internal transitions and are authenticated using each peer&#x27;s <em>Hydra key</em>. Each message sent is signed by the sender, and the signature is verified by the receiver.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-and-authorization">Authentication and authorization<a href="#authentication-and-authorization" class="hash-link" aria-label="Direct link to Authentication and authorization" title="Direct link to Authentication and authorization">​</a></h4><p>The messages exchanged through the <em>Hydra networking</em> layer between participants are authenticated. Each message is <a href="https://github.com/input-output-hk/hydra/issues/727" target="_blank" rel="noopener noreferrer">signed</a> using the Hydra signing key of the emitting party, which is identified by the corresponding verification key. When a message with an unknown or incorrect signature is received, it is dropped, and a notification is logged.</p><p>However, messages are not encrypted. If confidentiality is required, an external mechanism must be implemented to prevent other parties from observing the messages exchanged within a head.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="fault-tolerance">Fault tolerance<a href="#fault-tolerance" class="hash-link" aria-label="Direct link to Fault tolerance" title="Direct link to Fault tolerance">​</a></h4><p>The Hydra Head protocol guarantees the safety of all honest participants&#x27; funds but does not inherently guarantee liveness. Therefore, for the protocol to progress, all parties involved in a head must be online and reactive.</p><p>This means that if one or more participants&#x27; Hydra nodes become permanently unreachable due to a crash or network partition, no further transactions can occur in the head, and it must be closed. However, the <a href="https://hydra.family/head-protocol/unstable/haddock/hydra-node/Hydra-Node-Network.html" target="_blank" rel="noopener noreferrer">Hydra networking layer</a> is tolerant to transient disconnections and (non-Byzantine) crashes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="chain-interaction">Chain interaction<a href="#chain-interaction" class="hash-link" aria-label="Direct link to Chain interaction" title="Direct link to Chain interaction">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="chain">Chain<a href="#chain" class="hash-link" aria-label="Direct link to Chain" title="Direct link to Chain">​</a></h4><p>The <em>chain</em> component interfaces the Hydra node with the Cardano (layer 1) chain. The current implementation, called <code>Direct</code>, uses the <code>node-to-client</code> protocol to both &#x27;follow the chain&#x27; and observe new blocks and transactions that can change the state of the head. It also submits transactions in response to client requests or as needed to advance the protocol&#x27;s state. This component connects to a locally spun <code>cardano-node</code> using the <em>local socket</em> and contains the <em>off-chain</em> logic, based on <code>cardano-api</code>, which knows how to observe and build transactions relevant to the Hydra protocol. For more details, see <a href="/head-protocol/adr/10">ADR-10</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="wallet">Wallet<a href="#wallet" class="hash-link" aria-label="Direct link to Wallet" title="Direct link to Wallet">​</a></h4><p>The Hydra node maintains an internal wallet using the Cardano signing key provided to the <code>hydra-node</code>. This wallet is used to handle the payment of transaction fees and to sign transactions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="head-logic">Head logic<a href="#head-logic" class="hash-link" aria-label="Direct link to Head logic" title="Direct link to Head logic">​</a></h3><p>This component is at the core of the Hydra node, implementing the protocol&#x27;s <em>state machine</em>. It is structured around the concepts of <code>Input</code>s and <code>Effect</code>s. <code>Input</code>s from the outside world are interpreted against the current state, potentially resulting in internal <code>Event</code>s, which are aggregated into an updated state. This can then produce <code>Effect</code>s, leading to &#x27;side effects&#x27; on the outside world. The state available to the <em>head logic</em> consists of the head&#x27;s content (eg, current ledger, pending transactions) <em>and</em> the data from layer 1 needed to observe and trigger on-chain transitions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hydra-smart-contracts">Hydra smart contracts<a href="#hydra-smart-contracts" class="hash-link" aria-label="Direct link to Hydra smart contracts" title="Direct link to Hydra smart contracts">​</a></h3><p>This component represents all the Hydra smart contracts needed for the Hydra Head protocol operation. Currently, the contracts are written using <code>Plutus-Tx</code>. The scripts are optimized using a custom <code>ScriptContext</code> and specific error codes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="api">API<a href="#api" class="hash-link" aria-label="Direct link to API" title="Direct link to API">​</a></h3><p>The <code>hydra-node</code> component exposes an <a href="https://hydra.family/head-protocol/unstable/api-reference" target="_blank" rel="noopener noreferrer">asynchronous API</a> through a WebSocket server. This API is available to the <em>Hydra client</em> for sending commands and observing changes in the state of the Hydra head. Upon startup, the API server loads all historical messages from the persistence layer and serves them to clients interested in observing them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="persistence">Persistence<a href="#persistence" class="hash-link" aria-label="Direct link to Persistence" title="Direct link to Persistence">​</a></h3><p>All API server outputs and the <code>hydra-node</code> state are preserved on disk. The persistence layer is responsible for loading historical messages and the Hydra state from disk, as well as storing them. Currently, there hasn&#x27;t been a need to increase the complexity of this layer or use a database.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h3><p>The Hydra node logs all internal side effects as JSON-formatted messages to its <em>standard output</em> stream. The log format adheres to a documented <a href="https://raw.githubusercontent.com/input-output-hk/hydra/master/hydra-node/json-schemas/logs.yaml" target="_blank" rel="noopener noreferrer">JSON schema</a>, following the principles outlined in <a href="/head-protocol/adr/9">ADR-9</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">​</a></h3><p>The Hydra node <a href="https://hydra.family/head-protocol/docs/getting-started/quickstart#hydra-node-options" target="_blank" rel="noopener noreferrer">optionally</a> exposes <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus</a>-compliant <em>metrics</em> through an HTTP server, on the standard <code>/metrics</code> endpoint.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cardano-scaling/hydra/tree/master/docs/docs/dev/architecture/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/head-protocol/docs/dev/protocol"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Protocol</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/head-protocol/docs/dev/architecture/networking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Networking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#network" class="table-of-contents__link toc-highlight">Network</a></li><li><a href="#chain-interaction" class="table-of-contents__link toc-highlight">Chain interaction</a></li><li><a href="#head-logic" class="table-of-contents__link toc-highlight">Head logic</a></li><li><a href="#hydra-smart-contracts" class="table-of-contents__link toc-highlight">Hydra smart contracts</a></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#persistence" class="table-of-contents__link toc-highlight">Persistence</a></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li></ul></div></div></div></div></main></div></div><footer class="laptop:footer bg-white py-[56px]"><div class="flex justify-between flex-col-reverse laptop:flex-row w-full px-6 tablet:px-12 laptop:justify-normal laptop:gap-20"><div class="basis-1/6"><div class="flex flex-col gap-4 border border-solid border-primary-light p-6 rounded-lg mb-14 laptop:mb-[70px] w-[250px]"><div class="inline-flex items-center text-primary-light"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 29 29" fill="none" class="shrink-0"><path d="M20.9294 16.3976C20.9294 16.3976 20.9358 15.3266 20.3616 14.1253C19.0297 11.3398 14.9511 6.74717 2.44965 8.86911L0 13.0703L2.54633 15.0556C4.06401 14.4519 14.2443 8.67912 20.9294 16.3974V16.3976ZM4.08846 10.8233L3.24446 12.1819L1.88586 11.3379L4.08846 10.8233Z" fill="currentColor"></path><path d="M20.5776 20.3707C20.4668 19.713 19.3421 17.1372 16.296 15.7499C13.2916 14.3817 8.6545 14.2215 2.01156 18.1487L1.30078 22.5083L4.03963 23.745C4.03963 23.745 12.8396 14.251 20.5778 20.3704L20.5776 20.3707ZM3.72907 20.8007L2.16445 20.4564L4.07336 19.2358L3.72935 20.8004L3.72907 20.8007Z" fill="currentColor"></path><path d="M24.8502 4.43443C23.7434 3.24952 22.3305 2.38107 20.8536 1.74477L22.5703 0H12.2523L5.80469 2.91929L7.20152 5.91558C16.105 5.48023 22.8094 9.08584 23.1751 15.9556C23.5638 23.2615 16.3385 27.8964 9.38191 26.5819C7.07645 26.1462 5.89041 25.6401 5.89041 25.6401C7.46317 27.0198 10.67 28.7297 14.5114 28.7789C22.2549 28.8775 28.6281 22.5603 28.7751 14.6779C28.8495 10.6999 27.3408 7.08194 24.8496 4.43472L24.8502 4.43443ZM12.2526 3.01822L10.9311 1.69671H13.5741L12.2526 3.01822Z" fill="currentColor"></path></svg><span class="border-l pl-4 ml-4 text-xl leading-[27px]">Join the family</span></div><a class="px-4 py-3 justify-center text-center border text-sm border-solid bg-primary-lightest border-primary font-bold text-primary rounded-lg no-underline hover:bg-white hover:no-underline hover:text-primary" href="/head-protocol/docs/get-involved">Get involved</a></div><div class="text-primary-light inline-flex gap-4 text-center"><svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none"><path d="M20.9294 16.3976C20.9294 16.3976 20.9358 15.3266 20.3616 14.1253C19.0297 11.3398 14.9511 6.74717 2.44965 8.86911L0 13.0703L2.54633 15.0556C4.06401 14.4519 14.2443 8.67912 20.9294 16.3974V16.3976ZM4.08846 10.8233L3.24446 12.1819L1.88586 11.3379L4.08846 10.8233Z" fill="currentColor"></path><path d="M20.5776 20.3707C20.4668 19.713 19.3421 17.1372 16.296 15.7499C13.2916 14.3817 8.6545 14.2215 2.01156 18.1487L1.30078 22.5083L4.03963 23.745C4.03963 23.745 12.8396 14.251 20.5778 20.3704L20.5776 20.3707ZM3.72907 20.8007L2.16445 20.4564L4.07336 19.2358L3.72935 20.8004L3.72907 20.8007Z" fill="currentColor"></path><path d="M24.8502 4.43443C23.7434 3.24952 22.3305 2.38107 20.8536 1.74477L22.5703 0H12.2523L5.80469 2.91929L7.20152 5.91558C16.105 5.48023 22.8094 9.08584 23.1751 15.9556C23.5638 23.2615 16.3385 27.8964 9.38191 26.5819C7.07645 26.1462 5.89041 25.6401 5.89041 25.6401C7.46317 27.0198 10.67 28.7297 14.5114 28.7789C22.2549 28.8775 28.6281 22.5603 28.7751 14.6779C28.8495 10.6999 27.3408 7.08194 24.8496 4.43472L24.8502 4.43443ZM12.2526 3.01822L10.9311 1.69671H13.5741L12.2526 3.01822Z" fill="currentColor"></path></svg><span class="mt-0.5">© 2024</span></div></div><div class="grid gap-10 pb-10 max-w-md tablet:flex tablet:max-w-full laptop:pb-0 laptop:gap-7 basis-5/6 laptop:max-w-full"><div class="tablet:col basis-1/4"><div class="footer__title text-sm pb-1 laptop:pb-5 text-black">Contributing</div><ul class="footer__items clean-list space-y-2"><li class="footer__item"><a href="https://github.com/cardano-scaling/hydra/wiki/Coding-Standards" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Coding standards</a></li><li class="footer__item"><a class="footer__link-item inline-flex hover:text-primary-light text-black" href="/head-protocol/adr">Architecture Decision Records</a></li><li class="footer__item"><a href="https://github.com/cardano-scaling/hydra/wiki/Testing-Strategy" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Testing strategy</a></li></ul></div><div class="tablet:col basis-1/4"><div class="footer__title text-sm pb-1 laptop:pb-5 text-black">Community</div><ul class="footer__items clean-list space-y-2"><li class="footer__item"><a href="https://discord.gg/Qq5vNTg9PT" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Discord</a></li><li class="footer__item"><a href="https://github.com/cardano-scaling/hydra/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">GitHub discussions</a></li><li class="footer__item"><a href="https://cardano.stackexchange.com/questions/tagged/hydra" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Stack Exchange</a></li></ul></div><div class="tablet:col basis-1/4"><div class="footer__title text-sm pb-1 laptop:pb-5 text-black">More</div><ul class="footer__items clean-list space-y-2"><li class="footer__item"><a class="footer__link-item inline-flex hover:text-primary-light text-black" href="/head-protocol/docs/dev/haskell-packages">Haskell packages</a></li><li class="footer__item"><a href="https://cardano-scaling.github.io/website/monthly" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Monthly reports</a></li><li class="footer__item"><a href="https://github.com/cardano-scaling/hydra/wiki/Logbook" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Logbook</a></li></ul></div><div class="tablet:col basis-1/4"><div class="footer__title text-sm pb-1 laptop:pb-5 text-black">Legal</div><ul class="footer__items clean-list space-y-2"><li class="footer__item"><a href="https://static.iohk.io/terms/iohktermsandconditions.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Terms and conditions</a></li><li class="footer__item"><a href="https://static.iohk.io/terms/iog-privacy-policy.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Privacy policy</a></li><li class="footer__item"><a href="https://github.com/cardano-scaling/hydra/graphs/contributors" target="_blank" rel="noopener noreferrer" class="footer__link-item inline-flex hover:text-primary-light text-black">Contributors</a></li></ul></div></div></div></footer></div>
<script src="/head-protocol/assets/js/runtime~main.0c27f7af.js"></script>
<script src="/head-protocol/assets/js/main.908a8c3e.js"></script>
</body>
</html>